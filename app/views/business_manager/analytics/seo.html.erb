<div class="space-y-6">
  <!-- Header -->
  <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
    <div>
      <h1 class="text-2xl sm:text-3xl font-bold text-gray-900">SEO Analytics</h1>
      <p class="text-sm text-gray-600 mt-1">Optimize your search engine visibility and rankings</p>
    </div>
  </div>

  <!-- Navigation Tabs -->
  <div class="border-b border-gray-200">
    <nav class="-mb-px flex space-x-4 sm:space-x-8 overflow-x-auto">
      <%= link_to "Overview", business_manager_analytics_path,
          class: "whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" %>
      <%= link_to "Traffic", business_manager_analytics_traffic_path,
          class: "whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" %>
      <%= link_to "Conversions", business_manager_analytics_conversions_path,
          class: "whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" %>
      <%= link_to "Bookings", business_manager_analytics_bookings_path,
          class: "whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" %>
      <%= link_to "Services", business_manager_analytics_services_path,
          class: "whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" %>
      <% if @current_business.products.any? %>
        <%= link_to "Products", business_manager_analytics_products_path,
            class: "whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" %>
      <% end %>
      <%= link_to "SEO", business_manager_analytics_seo_path,
          class: "whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm border-blue-500 text-blue-600" %>
      <%= link_to "Export", business_manager_export_analytics_path,
          class: "whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" %>
    </nav>
  </div>

  <!-- SEO Score Card -->
  <div class="bg-white rounded-lg shadow p-6">
    <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-6">
      <div class="flex items-center gap-6">
        <!-- Score Circle -->
        <div class="relative">
          <div class="w-24 h-24 rounded-full flex items-center justify-center <%= seo_score_color(@analysis[:overall_score]) %>">
            <span class="text-3xl font-bold"><%= @analysis[:overall_score] %></span>
          </div>
        </div>
        <div>
          <h2 class="text-xl font-semibold text-gray-900">SEO Score</h2>
          <p class="text-sm text-gray-600 mt-1">
            <% case @analysis[:overall_score] %>
            <% when 0..30 %>
              Needs significant improvement
            <% when 31..60 %>
              Fair - Room for improvement
            <% when 61..80 %>
              Good - Keep optimizing
            <% when 81..100 %>
              Excellent! Well optimized
            <% end %>
          </p>
        </div>
      </div>
      
      <!-- Score Breakdown -->
      <div class="grid grid-cols-2 sm:grid-cols-4 gap-4">
        <% @analysis[:score_breakdown].each do |factor, score| %>
          <div class="text-center">
            <div class="text-lg font-bold <%= score >= 70 ? 'text-green-600' : score >= 40 ? 'text-yellow-600' : 'text-red-600' %>">
              <%= score %>
            </div>
            <div class="text-xs text-gray-500 capitalize"><%= factor.to_s.gsub('_', ' ') %></div>
          </div>
        <% end %>
      </div>
    </div>
  </div>

  <!-- Main Content Grid -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    
    <!-- Keyword Rankings -->
    <div class="bg-white rounded-lg shadow p-6">
      <h3 class="text-lg font-semibold text-gray-900 mb-4">Estimated Keyword Rankings</h3>
      <p class="text-xs text-gray-500 mb-4">Based on your business profile and industry analysis</p>
      
      <% if @analysis[:current_rankings].present? && @analysis[:current_rankings].any? %>
        <div class="space-y-3 max-h-96 overflow-y-auto">
          <% @analysis[:current_rankings].first(10).each do |keyword, data| %>
            <div class="flex items-center justify-between py-2 border-b border-gray-100 last:border-0">
              <div class="flex-1 min-w-0 mr-4">
                <div class="text-sm font-medium text-gray-900 truncate"><%= keyword %></div>
                <div class="text-xs text-gray-500"><%= data[:improvement_potential] %></div>
              </div>
              <div class="flex items-center gap-2">
                <%= ranking_badge(data[:position]) %>
                <% if data[:trend] == 'improving' %>
                  <svg class="w-4 h-4 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M5.293 9.707a1 1 0 010-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L11 7.414V15a1 1 0 11-2 0V7.414L6.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
                  </svg>
                <% elsif data[:trend] == 'declining' %>
                  <svg class="w-4 h-4 text-red-500" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M14.707 10.293a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 111.414-1.414L9 12.586V5a1 1 0 012 0v7.586l2.293-2.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                  </svg>
                <% end %>
              </div>
            </div>
          <% end %>
        </div>
      <% else %>
        <p class="text-sm text-gray-500 text-center py-8">No ranking data available yet</p>
      <% end %>
    </div>

    <!-- SEO Suggestions -->
    <div class="bg-white rounded-lg shadow p-6">
      <h3 class="text-lg font-semibold text-gray-900 mb-4">Improvement Suggestions</h3>
      
      <% if @analysis[:suggestions].present? && @analysis[:suggestions].any? %>
        <div class="space-y-4 max-h-96 overflow-y-auto">
          <% @analysis[:suggestions].first(10).each do |suggestion| %>
            <div class="p-3 border border-gray-200 rounded-lg">
              <div class="flex items-start justify-between mb-2">
                <h4 class="text-sm font-medium text-gray-900"><%= suggestion[:title] %></h4>
                <%= priority_badge(suggestion[:priority]) %>
              </div>
              <p class="text-sm text-gray-600"><%= suggestion[:suggestion] %></p>
              <div class="mt-2 flex items-center gap-4 text-xs text-gray-500">
                <span>Impact: +<%= suggestion[:impact] %> points</span>
                <span>Effort: <%= suggestion[:effort]&.capitalize || 'Medium' %></span>
              </div>
            </div>
          <% end %>
        </div>
      <% else %>
        <div class="text-center py-8">
          <svg class="w-12 h-12 mx-auto text-green-500 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
          <p class="text-sm text-gray-600">Great job! No critical issues found.</p>
        </div>
      <% end %>
    </div>

    <!-- Keyword Opportunities -->
    <div class="bg-white rounded-lg shadow p-6">
      <h3 class="text-lg font-semibold text-gray-900 mb-4">Keyword Opportunities</h3>
      <p class="text-xs text-gray-500 mb-4">Keywords with high potential for your business</p>
      
      <% if @analysis[:keyword_opportunities].present? && @analysis[:keyword_opportunities].any? %>
        <div class="space-y-3 max-h-80 overflow-y-auto">
          <% @analysis[:keyword_opportunities].first(10).each do |opportunity| %>
            <div class="flex items-center justify-between py-2 border-b border-gray-100 last:border-0">
              <div class="flex-1 min-w-0 mr-4">
                <div class="flex items-center gap-2">
                  <span class="text-sm font-medium text-gray-900 truncate"><%= opportunity[:keyword] %></span>
                  <% if opportunity[:quick_win] %>
                    <span class="px-1.5 py-0.5 text-xs font-medium rounded bg-green-100 text-green-800">Quick Win</span>
                  <% end %>
                </div>
              </div>
              <div class="flex items-center gap-3">
                <div class="text-right">
                  <div class="text-sm font-medium text-gray-900"><%= opportunity[:opportunity_score] %></div>
                  <div class="text-xs text-gray-500">Score</div>
                </div>
                <div class="text-right">
                  <div class="text-sm <%= opportunity[:difficulty] < 40 ? 'text-green-600' : opportunity[:difficulty] < 70 ? 'text-yellow-600' : 'text-red-600' %>">
                    <%= opportunity[:difficulty] %>
                  </div>
                  <div class="text-xs text-gray-500">Difficulty</div>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      <% else %>
        <p class="text-sm text-gray-500 text-center py-8">Analyzing keyword opportunities...</p>
      <% end %>
    </div>

    <!-- Local SEO Status -->
    <div class="bg-white rounded-lg shadow p-6">
      <h3 class="text-lg font-semibold text-gray-900 mb-4">Local SEO Checklist</h3>
      
      <% local_seo = @analysis[:local_seo_analysis] %>
      <div class="space-y-3">
        <div class="flex items-center justify-between py-2">
          <span class="text-sm text-gray-700">Complete Address</span>
          <% if local_seo[:address_complete] %>
            <span class="text-green-500"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg></span>
          <% else %>
            <span class="text-red-500"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/></svg></span>
          <% end %>
        </div>
        
        <div class="flex items-center justify-between py-2">
          <span class="text-sm text-gray-700">Phone Number</span>
          <% if local_seo[:phone_present] %>
            <span class="text-green-500"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg></span>
          <% else %>
            <span class="text-red-500"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/></svg></span>
          <% end %>
        </div>
        
        <div class="flex items-center justify-between py-2">
          <span class="text-sm text-gray-700">Business Hours</span>
          <% if local_seo[:hours_set] %>
            <span class="text-green-500"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg></span>
          <% else %>
            <span class="text-red-500"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/></svg></span>
          <% end %>
        </div>
        
        <div class="flex items-center justify-between py-2">
          <span class="text-sm text-gray-700">Google Business Profile</span>
          <% if local_seo[:google_profile_linked] %>
            <span class="text-green-500"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg></span>
          <% else %>
            <span class="text-red-500"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/></svg></span>
          <% end %>
        </div>
        
        <div class="flex items-center justify-between py-2">
          <span class="text-sm text-gray-700">Location in Content</span>
          <% if local_seo[:local_keywords_in_content] %>
            <span class="text-green-500"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg></span>
          <% else %>
            <span class="text-red-500"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/></svg></span>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <!-- Structured Data Preview -->
  <div class="bg-white rounded-lg shadow p-6">
    <h3 class="text-lg font-semibold text-gray-900 mb-4">Structured Data (Schema.org)</h3>
    <p class="text-sm text-gray-600 mb-4">This data helps search engines understand your business better.</p>
    
    <details class="group">
      <summary class="cursor-pointer text-sm font-medium text-blue-600 hover:text-blue-800">
        View LocalBusiness Schema
      </summary>
      <pre class="mt-4 p-4 bg-gray-50 rounded-lg text-xs overflow-x-auto"><code><%= JSON.pretty_generate(@local_business_schema) %></code></pre>
    </details>
  </div>
</div>

