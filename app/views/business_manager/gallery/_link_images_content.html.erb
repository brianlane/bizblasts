<%# Local variable: available_images (Hash with :services and :products keys) %>

<div class="space-y-6">
  <!-- Services Images -->
  <% if available_images[:services].any? %>
    <div>
      <h4 class="text-base font-medium text-gray-900 mb-3">Service Images</h4>
      <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
        <% available_images[:services].each do |image| %>
          <div class="relative group border border-gray-200 rounded-lg overflow-hidden hover:border-blue-500 transition">
            <img src="<%= image[:thumbnail_url] %>"
                 alt="<%= image[:source_name] %>"
                 class="w-full h-32 object-cover">

            <div class="p-2">
              <p class="text-xs font-medium text-gray-900 truncate"><%= image[:source_name] %></p>
              <p class="text-xs text-gray-500 truncate"><%= image[:attachment_filename] %></p>
            </div>

            <!-- Hover Overlay -->
            <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-opacity duration-200 flex items-center justify-center opacity-0 group-hover:opacity-100">
              <%= form_with url: business_manager_gallery_photos_path, method: :post,
                           data: { turbo: true, action: "submit->modal#close" } do |f| %>
                <%= f.hidden_field :source_type, value: image[:source_type] %>
                <%= f.hidden_field :source_id, value: image[:source_id] %>
                <%= f.hidden_field :attachment_id, value: image[:attachment_id] %>
                <%= f.submit "Add to Gallery", class: "btn btn-sm btn-primary" %>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  <% else %>
    <div class="text-center py-6 bg-gray-50 rounded-lg">
      <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/>
      </svg>
      <p class="mt-2 text-sm text-gray-500">No service images available</p>
      <p class="mt-1 text-xs text-gray-400">Add photos to your services first</p>
    </div>
  <% end %>

  <!-- Products Images -->
  <% if available_images[:products].any? %>
    <div>
      <h4 class="text-base font-medium text-gray-900 mb-3">Product Images</h4>
      <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
        <% available_images[:products].each do |image| %>
          <div class="relative group border border-gray-200 rounded-lg overflow-hidden hover:border-blue-500 transition">
            <img src="<%= image[:thumbnail_url] %>"
                 alt="<%= image[:source_name] %>"
                 class="w-full h-32 object-cover">

            <div class="p-2">
              <p class="text-xs font-medium text-gray-900 truncate"><%= image[:source_name] %></p>
              <p class="text-xs text-gray-500 truncate"><%= image[:attachment_filename] %></p>
            </div>

            <!-- Hover Overlay -->
            <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-opacity duration-200 flex items-center justify-center opacity-0 group-hover:opacity-100">
              <%= form_with url: business_manager_gallery_photos_path, method: :post,
                           data: { turbo: true, action: "submit->modal#close" } do |f| %>
                <%= f.hidden_field :source_type, value: image[:source_type] %>
                <%= f.hidden_field :source_id, value: image[:source_id] %>
                <%= f.hidden_field :attachment_id, value: image[:attachment_id] %>
                <%= f.submit "Add to Gallery", class: "btn btn-sm btn-primary" %>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  <% else %>
    <div class="text-center py-6 bg-gray-50 rounded-lg">
      <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
      </svg>
      <p class="mt-2 text-sm text-gray-500">No product images available</p>
      <p class="mt-1 text-xs text-gray-400">Add photos to your products first</p>
    </div>
  <% end %>

  <% if available_images[:services].empty? && available_images[:products].empty? %>
    <div class="text-center py-12">
      <svg class="mx-auto h-16 w-16 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
      </svg>
      <h3 class="mt-4 text-lg font-medium text-gray-900">No Images Available</h3>
      <p class="mt-2 text-sm text-gray-500">Upload photos to your services or products first, then you can link them to your gallery.</p>
      <div class="mt-6 flex justify-center gap-4">
        <%= link_to "Manage Services", business_manager_services_path, class: "btn btn-primary cursor-pointer" %>
        <%= link_to "Manage Products", business_manager_products_path, class: "btn btn-secondary cursor-pointer" %>
      </div>
    </div>
  <% end %>
</div>
