<h1>Order <%= @order.order_number %></h1>

<p>
  <strong>Customer:</strong>
  <%= @order.tenant_customer.name %>
</p>

<p>
  <strong>Status:</strong>
  <%= @order.status %>
</p>

<% if @order.product? %>
  <h2>Products</h2>
<% elsif @order.service? %>
  <h2>Services</h2>
<% else %>
  <h2>Products & Services</h2>
<% end %>

<table>
  <thead>
    <tr>
      <th>Item</th>
      <th>Quantity</th>
      <th>Unit Price</th>
      <th>Total</th>
    </tr>
  </thead>

  <tbody>
    <% @order.line_items.each do |item| %>
      <tr>
        <td><%= item.lineable.name %></td>
        <td><%= item.quantity %></td>
        <td><%= number_to_currency(item.unit_price) %></td>
        <td><%= number_to_currency(item.total_amount) %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<p>
  <strong>Subtotal:</strong>
  <%= number_to_currency(@order.line_items.sum(&:total_amount)) %>
</p>

<% if @order.shipping_method.present? %>
  <p>
    <strong>Shipping:</strong>
    <%= number_to_currency(@order.shipping_amount) %> via <%= @order.shipping_method.name %>
  </p>
<% end %>

<% if @order.tax_rate.present? %>
  <p>
    <strong>Tax:</strong>
    <%= number_to_currency(@order.tax_amount) %> (<%= @order.tax_rate.rate %>%)
  </p>
<% end %>

<p>
  <strong>Total:</strong>
  <%= number_to_currency(@order.total_amount) %>
</p>

<%= link_to 'Edit', edit_order_path(@order) %> |
<%= link_to 'Back', orders_path %> 