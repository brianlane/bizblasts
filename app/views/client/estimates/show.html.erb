<% content_for :title, "Estimate ##{@estimate.id}" %>

<div class="container mx-auto px-4 py-6 max-w-2xl">
  <div class="flex justify-between items-center mb-4">
    <h1 class="text-2xl font-bold">Estimate #<%= @estimate.id %></h1>
    <%= link_to 'Back to My Estimates', client_estimates_path, class: 'text-blue-600 hover:text-blue-800' %>
  </div>

  <%= render 'public/estimates/estimate_details', estimate: @estimate %>

  <% if @estimate.approved? && @estimate.booking.present? %>
    <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4">
      <strong>Approved!</strong> This estimate was approved on <%= @estimate.approved_at&.strftime('%B %d, %Y at %I:%M %p') %>.
      <%= link_to 'View Booking', booking_path(@estimate.booking), class: 'underline font-medium' %>
    </div>
  <% elsif @estimate.declined? %>
    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
      <strong>Declined</strong> This estimate was declined on <%= @estimate.declined_at&.strftime('%B %d, %Y at %I:%M %p') %>.
    </div>
  <% elsif @estimate.cancelled? %>
    <div class="bg-gray-100 border border-gray-400 text-gray-700 px-4 py-3 rounded mb-4">
      <strong>Cancelled</strong> This estimate has been cancelled.
    </div>
  <% elsif @estimate.draft? || @estimate.sent? || @estimate.viewed? %>
    <div class="bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded mb-4">
      <strong>Pending Review</strong> This estimate is awaiting your review.
      <% if @estimate.token.present? %>
        <%= link_to 'View & Respond', public_estimate_path(token: @estimate.token), class: 'underline font-medium' %>
      <% end %>
    </div>
  <% end %>
</div>
